<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cricket Broadcast Overlay</title>
<script src="https://js.pusher.com/8.2/pusher.min.js"></script>

<style>
html,body{
  margin:0;
  width:1920px;
  height:1080px;
  background:transparent;
  overflow:hidden;
  font-family:'Segoe UI','Arial Black',sans-serif;
}

/* ============================= */
/* CONNECTION DOT */
/* ============================= */
#connectionDot{
  position:absolute;
  top:20px;
  left:20px;
  width:12px;
  height:12px;
  border-radius:50%;
  background:#facc15;
  z-index:9999;
}

/* ============================= */
/* LOWER THIRD */
/* ============================= */
#lowerThird{
  position:absolute;
  bottom:220px;
  left:160px;
  width:1500px;
  height:260px;
  opacity:0;
  transform:translateX(-120%);
  transition:all .45s cubic-bezier(.22,.9,.3,1);
}

/* TEXT */
#ltTeam{
  position:absolute;
  top:55px;
  width:100%;
  text-align:center;
  font-size:24px;
  font-weight:800;
  letter-spacing:.15em;
  color:#ffffff;
  text-transform:uppercase;
}

#ltLabel{
  position:absolute;
  top:95px;
  width:100%;
  text-align:center;
  font-size:22px;
  font-weight:800;
  color:#000;
}

#ltName{
  position:absolute;
  top:120px;
  width:100%;
  text-align:center;
  font-size:80px;
  font-weight:900;
  color:#ffffff;
  white-space:nowrap;
}

#separator{
  position:absolute;
  top:190px;
  left:50%;
  transform:translateX(-50%);
  width:420px;
  height:3px;
  background:rgba(255,255,255,0.85);
  border-radius:2px;
}

#ltHand{
  position:absolute;
  top:205px;
  width:100%;
  text-align:center;
  font-size:22px;
  letter-spacing:.12em;
  color:#e5e7eb;
  text-transform:uppercase;
}

/* HEADSHOT */
#playerImage{
  position:absolute;
  top:70px;
  left:110px;
  width:110px;
  height:110px;
  border-radius:50%;
  object-fit:cover;
  border:4px solid #FFD700;
  display:none;
  z-index:10;
}

/* ============================= */
/* MOMENT BOX */
/* ============================= */
#momentBox{
  position:absolute;
  bottom:520px;
  left:50%;
  transform:translateX(-50%) scale(.8);
  padding:30px 80px;
  font-size:90px;
  font-weight:900;
  background:#FFD700;
  color:#000;
  border-radius:14px;
  opacity:0;
  transition:all .3s ease;
  z-index:9999;
  letter-spacing:.05em;
}
</style>
</head>

<body>

<div id="connectionDot"></div>

<div id="lowerThird">

<svg width="1500" height="260" viewBox="0 0 1500 260">

<defs>
  <linearGradient id="panelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
    <stop offset="0%" stop-color="#111827"/>
    <stop offset="100%" stop-color="#1f2937"/>
  </linearGradient>

  <linearGradient id="blueGrad" x1="0%" y1="0%" x2="100%" y2="0%">
    <stop offset="0%" stop-color="#2563eb"/>
    <stop offset="100%" stop-color="#1e3a8a"/>
  </linearGradient>
</defs>

<!-- MAIN PANEL -->
<polygon points="320,40 1400,40 1360,220 360,220"
         fill="url(#panelGrad)"/>

<!-- TEAM TAB -->
<polygon points="360,40 700,40 680,90 360,90"
         fill="url(#blueGrad)"/>

<!-- PURE GOLD BAR -->
<polygon points="331,90 1389,90 1382,120 338,120"
         fill="#FFD700"/>

</svg>

<img id="playerImage">

<div id="ltTeam"></div>
<div id="ltLabel">NEW BATSMAN</div>
<div id="ltName"></div>
<div id="separator"></div>
<div id="ltHand"></div>

</div>

<div id="momentBox"></div>

<script>

/* ============================= */
/* PUSHER SETUP */
/* ============================= */

const PUSHER_KEY="12fcceaea77e52cf3626";

const pusher = new Pusher(PUSHER_KEY,{
  cluster:'us2',
  forceTLS:true
});

const channel = pusher.subscribe('broadcast');

/* CONNECTION DOT */
const dot = document.getElementById('connectionDot');
pusher.connection.bind('connected',()=>dot.style.background='#22c55e');
pusher.connection.bind('connecting',()=>dot.style.background='#facc15');
pusher.connection.bind('disconnected',()=>dot.style.background='#ef4444');

/* ELEMENT REFERENCES */
const lowerThird = document.getElementById('lowerThird');
const teamEl = document.getElementById('ltTeam');
const nameEl = document.getElementById('ltName');
const handEl = document.getElementById('ltHand');
const imgEl = document.getElementById('playerImage');
const momentBox = document.getElementById('momentBox');

/* TIMERS */
let playerTimer = null;
let momentTimer = null;

/* AUTO SCALE NAME */
function autoScale(){
  nameEl.style.fontSize="80px";
  while(nameEl.scrollWidth > 1100){
    let size = parseInt(window.getComputedStyle(nameEl).fontSize);
    if(size <= 40) break;
    nameEl.style.fontSize = (size-2)+"px";
  }
}

/* ============================= */
/* PLAYER EVENT */
/* ============================= */
channel.bind('player', data => {

  if(!data) return;

  if(playerTimer) clearTimeout(playerTimer);

  teamEl.textContent = data.team || '';
  nameEl.textContent = data.name || '';
  handEl.textContent = data.hand || '';

  autoScale();

  if(data.image){
    imgEl.src = data.image;
    imgEl.style.display = 'block';
  } else {
    imgEl.style.display = 'none';
  }

  lowerThird.style.opacity='1';
  lowerThird.style.transform='translateX(0)';

  playerTimer = setTimeout(()=>{
    lowerThird.style.opacity='0';
    lowerThird.style.transform='translateX(-120%)';
  },7000);
});

/* ============================= */
/* MOMENT EVENT */
/* ============================= */
channel.bind('moment', data => {

  if(!data || !data.type) return;

  if(momentTimer) clearTimeout(momentTimer);

  let text = "";

  if(data.type === "4") text = "FOUR";
  if(data.type === "6") text = "SIX";
  if(data.type === "W") text = "WICKET";

  momentBox.textContent = text;

  momentBox.style.opacity="1";
  momentBox.style.transform="translateX(-50%) scale(1)";

  momentTimer = setTimeout(()=>{
    momentBox.style.opacity="0";
    momentBox.style.transform="translateX(-50%) scale(.8)";
  },4000);
});

</script>

</body>
</html>
