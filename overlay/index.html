<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NYC Eagles Broadcast Overlay</title>
<script src="https://js.pusher.com/8.2/pusher.min.js"></script>

<style>
html,body{
  margin:0;
  padding:0;
  width:1920px;
  height:1080px;
  background:transparent;
  overflow:hidden;
  font-family:'Segoe UI', Arial, sans-serif;
}

/* CONNECTION DOT */
#connectionDot{
  position:absolute;
  top:20px;
  left:20px;
  width:12px;
  height:12px;
  border-radius:50%;
  background:#facc15;
  z-index:9999;
}

/* LOWER THIRD CONTAINER */
#lowerThird{
  position:absolute;
  bottom:120px;
  left:140px;
  width:1400px;
  height:360px;
  transform:translateX(-150%);
  opacity:0;
  transition:all .6s cubic-bezier(.22,.9,.3,1);
}

/* TEXT STYLING */
#ltTeam{
  position:absolute;
  top:70px;
  left:300px;
  font-size:32px;
  font-weight:800;
  letter-spacing:.15em;
  color:white;
}

#ltLabel{
  position:absolute;
  top:110px;
  left:300px;
  font-size:30px;
  font-weight:900;
  color:black;
}

#ltName{
  position:absolute;
  top:160px;
  left:300px;
  font-size:90px;
  font-weight:900;
  color:white;
  white-space:nowrap;
}

#ltHand{
  position:absolute;
  top:265px;
  left:300px;
  font-size:28px;
  letter-spacing:.12em;
  color:#e5e7eb;
}

/* HEADSHOT */
#playerImage{
  position:absolute;
  top:60px;
  left:40px;
  width:240px;
  height:240px;
  border-radius:50%;
  object-fit:cover;
  display:none;
}

/* SCORE */
#manualScore{
  position:absolute;
  bottom:40px;
  left:50%;
  transform:translateX(-50%);
  display:none;
}

#scoreText{
  background:#111827;
  padding:18px 48px;
  border-radius:8px;
  font-size:36px;
  font-weight:900;
  letter-spacing:.1em;
  color:#fff;
}

/* SPONSOR */
#sponsorBox{
  position:absolute;
  top:40px;
  right:60px;
  width:320px;
  height:120px;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.6);
  border-radius:14px;
  overflow:hidden;
}

#sponsorBox img{
  max-width:90%;
  max-height:90%;
}

/* MOMENT */
#momentStinger{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.75);
  backdrop-filter:blur(4px);
  opacity:0;
  pointer-events:none;
  transition:opacity .3s ease;
  z-index:5000;
}

#momentText{
  font-size:220px;
  font-weight:900;
  letter-spacing:.1em;
  transform:scale(.6);
  transition:transform .4s cubic-bezier(.22,.9,.3,1);
}
</style>
</head>

<body>

<div id="connectionDot"></div>

<div id="lowerThird">

  <!-- SVG BASE -->
  <svg width="1400" height="360" viewBox="0 0 1400 360">

    <!-- Blue Base -->
    <polygon points="260,40 1350,40 1400,340 200,340"
             fill="#0f172a"/>

    <!-- Bottom Accent -->
    <rect x="200" y="330" width="1200" height="6"
          fill="#3b82f6"/>

    <!-- Gold Strip -->
    <polygon points="260,80 1320,80 1290,130 260,130"
             fill="url(#goldGrad)"/>

    <!-- Headshot Ring -->
    <circle cx="160" cy="180" r="120"
            fill="none"
            stroke="url(#goldGrad)"
            stroke-width="18"/>

    <defs>
      <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#fef08a"/>
        <stop offset="50%" stop-color="#facc15"/>
        <stop offset="100%" stop-color="#eab308"/>
      </linearGradient>
    </defs>

  </svg>

  <img id="playerImage">

  <div id="ltTeam"></div>
  <div id="ltLabel">NEW BATSMAN</div>
  <div id="ltName"></div>
  <div id="ltHand"></div>

</div>

<div id="manualScore">
  <div id="scoreText"></div>
</div>

<div id="sponsorBox"></div>

<div id="momentStinger">
  <div id="momentText"></div>
</div>

<script>

const PUSHER_KEY = "12fcceaea77e52cf3626";
const pusher = new Pusher(PUSHER_KEY,{cluster:'us2'});
const channel = pusher.subscribe('broadcast');

const dot = document.getElementById('connectionDot');
pusher.connection.bind('connected',()=>dot.style.background='#22c55e');
pusher.connection.bind('connecting',()=>dot.style.background='#facc15');
pusher.connection.bind('disconnected',()=>dot.style.background='#ef4444');

const lowerThird = document.getElementById('lowerThird');
const nameEl = document.getElementById('ltName');

/* AUTO SCALE NAME */
function autoScaleName(){
  nameEl.style.fontSize = "90px";
  while(nameEl.scrollWidth > 1000){
    let size = parseInt(window.getComputedStyle(nameEl).fontSize);
    nameEl.style.fontSize = (size - 2) + "px";
  }
}

/* PLAYER */
channel.bind('player', data => {
  if(!data) return;

  document.getElementById('ltTeam').textContent = data.team || '';
  nameEl.textContent = data.name || '';
  document.getElementById('ltHand').textContent = data.hand || '';

  autoScaleName();

  if(data.image){
    const img = document.getElementById('playerImage');
    img.src = data.image;
    img.style.display = 'block';
  }

  lowerThird.style.opacity='1';
  lowerThird.style.transform='translateX(0)';

  setTimeout(()=>{
    lowerThird.style.opacity='0';
    lowerThird.style.transform='translateX(-150%)';
  },7000);
});

/* SCORE */
channel.bind('manualScore',data=>{
  document.getElementById('manualScore').style.display='block';
  document.getElementById('scoreText').textContent =
    `${data.score || ''} | ${data.overs || ''}`;
});

channel.bind('score',data=>{
  if(data.auto){
    document.getElementById('manualScore').style.display='none';
  }
});

/* SPONSOR */
let sponsorInterval;
channel.bind('sponsor',data=>{
  const box = document.getElementById('sponsorBox');

  if(!data.enabled){
    box.style.display='none';
    clearInterval(sponsorInterval);
    return;
  }

  box.style.display='flex';
  const list = data.list || [];
  if(!list.length) return;

  let i=0;
  box.innerHTML=`<img src="${list[0]}">`;

  clearInterval(sponsorInterval);
  sponsorInterval=setInterval(()=>{
    i=(i+1)%list.length;
    box.innerHTML=`<img src="${list[i]}?t=${Date.now()}">`;
  },(data.interval||8)*1000);
});

/* MOMENT */
channel.bind('moment',data=>{
  if(!data || !data.type) return;

  const stinger=document.getElementById('momentStinger');
  const text=document.getElementById('momentText');

  let color='#facc15';
  if(data.type==='SIX') color='#22c55e';
  if(data.type==='WICKET') color='#ef4444';

  text.textContent=data.type;
  text.style.color=color;

  stinger.style.opacity='1';
  text.style.transform='scale(1)';

  setTimeout(()=>{
    stinger.style.opacity='0';
    text.style.transform='scale(.6)';
  },2500);
});

</script>

</body>
</html>
