<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NYC Eagles Broadcast Overlay</title>
<script src="https://js.pusher.com/8.2/pusher.min.js"></script>

<style>
html,body{
  margin:0;
  width:1920px;
  height:1080px;
  background:transparent;
  overflow:hidden;
  font-family:'Segoe UI','Arial Black',sans-serif;
}

/* ================= CONNECTION DOT ================= */

#connectionDot{
  position:absolute;
  top:20px;
  left:20px;
  width:12px;
  height:12px;
  border-radius:50%;
  background:#facc15;
  z-index:9999;
}

/* ================= LOWER THIRD ================= */

#lowerThird{
  position:absolute;
  bottom:260px;
  left:200px;
  width:1200px;
  height:220px;
  opacity:0;
  transform:translateX(-120%);
  transition:all .6s cubic-bezier(.22,.9,.3,1);
}

/* TEAM TAB TEXT */
#ltTeam{
  position:absolute;
  top:28px;
  left:330px;
  font-size:22px;
  font-weight:900;
  letter-spacing:.15em;
  color:#ffffff;
  text-transform:uppercase;
}

/* GOLD STRIP TEXT */
#ltLabel{
  position:absolute;
  top:72px;
  left:360px;
  font-size:22px;
  font-weight:900;
  color:#1f2937;
  letter-spacing:.08em;
}

#ltName{
  position:absolute;
  top:100px;
  left:360px;
  font-size:60px;
  font-weight:900;
  color:#ffffff;
  letter-spacing:.04em;
}

#separator{
  position:absolute;
  top:165px;
  left:360px;
  width:480px;
  height:2px;
  background:rgba(255,255,255,.6);
}

#ltHand{
  position:absolute;
  top:175px;
  left:360px;
  font-size:20px;
  font-weight:700;
  color:#cbd5e1;
  letter-spacing:.12em;
}

/* HEADSHOT */
#playerImage{
  position:absolute;
  top:10px;
  left:130px;
  width:160px;
  height:160px;
  border-radius:50%;
  object-fit:cover;
  border:6px solid #facc15;
  box-shadow:0 0 20px rgba(0,0,0,.5);
  display:none;
  z-index:10;
}

/* MOMENT STINGER */
#momentStinger{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.75);
  backdrop-filter:blur(6px);
  opacity:0;
  pointer-events:none;
  transition:opacity .3s ease;
  z-index:5000;
}

#momentText{
  font-size:220px;
  font-weight:900;
  letter-spacing:.1em;
  transform:scale(.6);
  transition:transform .4s cubic-bezier(.22,.9,.3,1);
}
</style>
</head>

<body>

<div id="connectionDot"></div>

<div id="lowerThird">

<svg width="1200" height="220" viewBox="0 0 1200 220">

<defs>
  <linearGradient id="panelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
    <stop offset="0%" stop-color="#1e293b"/>
    <stop offset="100%" stop-color="#0f172a"/>
  </linearGradient>

  <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="0%">
    <stop offset="0%" stop-color="#facc15"/>
    <stop offset="50%" stop-color="#fbbf24"/>
    <stop offset="100%" stop-color="#f59e0b"/>
  </linearGradient>

  <linearGradient id="blueGrad" x1="0%" y1="0%" x2="100%" y2="0%">
    <stop offset="0%" stop-color="#2563eb"/>
    <stop offset="100%" stop-color="#1e3a8a"/>
  </linearGradient>
</defs>

<!-- DARK PANEL -->
<polygon points="300,40 1120,40 1080,200 260,200"
         fill="url(#panelGrad)"/>

<!-- GOLD STRIP -->
<polygon points="320,70 1100,70 1065,115 285,115"
         fill="url(#goldGrad)"/>

<!-- BLUE TEAM TAB -->
<polygon points="320,40 550,40 520,75 290,75"
         fill="url(#blueGrad)"/>

</svg>

<img id="playerImage">

<div id="ltTeam"></div>
<div id="ltLabel">NEW BATSMAN</div>
<div id="ltName"></div>
<div id="separator"></div>
<div id="ltHand"></div>

</div>

<div id="momentStinger">
  <div id="momentText"></div>
</div>

<script>

const PUSHER_KEY="12fcceaea77e52cf3626";

const pusher=new Pusher(PUSHER_KEY,{
  cluster:'us2',
  forceTLS:true
});

const channel=pusher.subscribe('broadcast');

/* CONNECTION DOT */
const dot=document.getElementById('connectionDot');
pusher.connection.bind('connected',()=>dot.style.background='#22c55e');
pusher.connection.bind('connecting',()=>dot.style.background='#facc15');
pusher.connection.bind('disconnected',()=>dot.style.background='#ef4444');

/* ELEMENTS */
const lowerThird=document.getElementById('lowerThird');
const teamEl=document.getElementById('ltTeam');
const nameEl=document.getElementById('ltName');
const handEl=document.getElementById('ltHand');
const imgEl=document.getElementById('playerImage');

const momentStinger=document.getElementById('momentStinger');
const momentText=document.getElementById('momentText');

let playerTimer=null;
let momentTimer=null;

/* PLAYER EVENT */
channel.bind('player',data=>{
  if(!data) return;
  if(playerTimer) clearTimeout(playerTimer);

  teamEl.textContent=data.team||'';
  nameEl.textContent=data.name||'';
  handEl.textContent=data.hand||'';

  if(data.image){
    imgEl.src=data.image;
    imgEl.style.display='block';
  } else {
    imgEl.style.display='none';
  }

  lowerThird.style.opacity='1';
  lowerThird.style.transform='translateX(0)';

  playerTimer=setTimeout(()=>{
    lowerThird.style.opacity='0';
    lowerThird.style.transform='translateX(-120%)';
  },7000);
});

/* MOMENT EVENT */
channel.bind('moment',data=>{
  if(!data || !data.type) return;
  if(momentTimer) clearTimeout(momentTimer);

  let raw=data.type.toString().toUpperCase();
  let display="";
  let color="#facc15";

  if(raw==="4"||raw==="FOUR"){ display="FOUR"; color="#facc15"; }
  else if(raw==="6"||raw==="SIX"){ display="SIX"; color="#22c55e"; }
  else if(raw==="W"||raw==="WICKET"){ display="WICKET"; color="#ef4444"; }

  momentText.textContent=display;
  momentText.style.color=color;

  momentStinger.style.opacity='1';
  momentText.style.transform='scale(1)';

  momentTimer=setTimeout(()=>{
    momentStinger.style.opacity='0';
    momentText.style.transform='scale(.6)';
  },2500);
});

</script>

</body>
</html>
